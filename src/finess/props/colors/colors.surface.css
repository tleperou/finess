@import './../media/media.prefers.css';
@import './utils.css';

:where(html) {
  /* 
   * The only public color `surface`
   * to customise the color palette is:
   * 
   * --color-surface
   *
   * In the order of priority: 
   * 1. user (--color-surface)
   * 2. hdr
   * 3. system
   * 4. default
  */

  /* 
   * defaults are used when neither --color-surface 
   * is set or <color-system> isn't supported
   * https://developer.mozilla.org/en-US/docs/Web/CSS/system-color
   */

  --color-surface-default-hex: #121210;
  --color-surface-mix-hex: #f8fafb;
  --color-surface-default-p3: color(display-p3 0.070588 0.070588 0.062745 / 1);
  --color-surface-mix-p3: color(display-p3 0.972549 0.980392 0.984314 / 1);

  /* 
   * dark (default)
   */

  --color-surface-default: var(--color-surface-default-hex);
  --color-surface-mix: var(--color-surface-mix-hex);
  --color-surface-contrast: 3;
  --color-surface-mode: in oklch shorter hue;

  @media (--hdr) {
    --color-surface-default: var(--color-surface-default-p3);
    --color-surface-mix: var(--color-surface-mix-p3);
  }

  @supports (color: Canvas) and (color: CanvasText) {
    --color-surface-default: Canvas;
    --color-surface-mix: CanvasText;
  }

  @media (--contrast-reduced) {
    --color-surface-contrast: 1;
  }

  /* light */

  @media (--light) {
    --color-surface-default: var(--color-surface-mix-hex);
    --color-surface-mix: var(--color-surface-default-hex);
    --color-surface-contrast: 3;

    @supports (color: Canvas) {
      --color-surface-default: CanvasText;
      --color-surface-mix: Canvas;
    }
  }

  @media (--hdr-light) {
    --color-surface-default: var(--color-surface-mix-p3);
    --color-surface-mix: var(--color-surface-default-p3);
  }

  @media (--light-contrast-reduced) {
    --color-surface-contrast: 3.35;
  }

  /* color surface definitions */

  --color-surface-1: color-mix(
    var(--color-surface-mode),
    var(--color-surface, var(--color-surface-default)),
    calc(0.1% * var(--color-surface-contrast)) var(--color-surface-mix)
  );

  --color-surface-2: color-mix(
    var(--color-surface-mode),
    var(--color-surface-1),
    calc(7.25% * var(--color-surface-contrast)) var(--color-surface-mix)
  );

  --color-surface-3: color-mix(
    var(--color-surface-mode),
    var(--color-surface-1),
    calc(15% * var(--color-surface-contrast)) var(--color-surface-mix)
  );

  --color-surface-4: color-mix(
    var(--color-surface-mode),
    var(--color-surface-1),
    calc(25% * var(--color-surface-contrast)) var(--color-surface-mix)
  );

  --color-surface-5: color-mix(
    var(--color-surface-mode),
    var(--color-surface-1),
    calc(33% * var(--color-surface-contrast)) var(--color-surface-mix)
  );
}
